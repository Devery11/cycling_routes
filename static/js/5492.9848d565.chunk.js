"use strict";(self.webpackChunkcycling_routes=self.webpackChunkcycling_routes||[]).push([[5492],{4815:(e,n,a)=>{var i,r;function t(e){return e&&"esri.renderers.visualVariables.SizeVariable"===e.declaredClass}function l(e){return null!=e&&!isNaN(e)&&isFinite(e)}function s(e){return e.valueExpression?i.Expression:e.field&&"string"==typeof e.field?i.Field:i.Unknown}function o(e,n){const a=n||s(e),t=e.valueUnit||"unknown";return a===i.Unknown?r.Constant:e.stops?r.Stops:null!=e.minSize&&null!=e.maxSize&&null!=e.minDataValue&&null!=e.maxDataValue?r.ClampedLinear:"unknown"===t?null!=e.minSize&&null!=e.minDataValue?e.minSize&&e.minDataValue?r.Proportional:r.Additive:r.Identity:r.RealWorldSize}a.d(n,{KZ:()=>o,Yf:()=>i,_w:()=>r,eh:()=>s,gf:()=>l,of:()=>t}),function(e){e.Unknown="unknown",e.Expression="expression",e.Field="field"}(i||(i={})),function(e){e.Unknown="unknown",e.Stops="stops",e.ClampedLinear="clamped-linear",e.Proportional="proportional",e.Additive="additive",e.Constant="constant",e.Identity="identity",e.RealWorldSize="real-world-size"}(r||(r={}))},15492:(e,n,a)=>{a.r(n),a.d(n,{getAllSizes:()=>S,getColor:()=>v,getOpacity:()=>p,getRotationAngle:()=>b,getSize:()=>h,getSizeForValue:()=>w,getSizeFromNumberOrVariable:()=>m,getSizeRangeAtScale:()=>x,getVisualVariableValues:()=>g,viewScaleRE:()=>f});var i=a(69539),r=a(39356),t=a(4212),l=a(76460),s=a(3454),o=a(4815);const u=()=>l.A.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),c=new r.A,d=Math.PI,f=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function v(e,n,a){const r="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"color"===e.type)):e;if(!r)return;if("esri.renderers.visualVariables.ColorVariable"!==r.declaredClass)return void u().warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const t="number"==typeof n,l=t?null:n,s=null===l||void 0===l?void 0:l.attributes;let o=t?n:null;const c=r.field,{ipData:d,hasExpression:f}=r.cache;let v=r.cache.compiledFunc;if(!c&&!f){const e=r.stops;return e&&e[0]&&e[0].color}if("number"!=typeof o)if(f){if(null==(null===a||void 0===a?void 0:a.arcade))return void u().error("Use of arcade expressions requires an arcade context");const e={viewingMode:a.viewingMode,scale:a.scale,spatialReference:a.spatialReference},n=a.arcade.arcadeUtils,i=n.getViewInfo(e),t=n.createExecContext(l,i,a.timeZone);if(!v){const e=n.createSyntaxTree(r.valueExpression);v=n.createFunction(e),r.cache.compiledFunc=v}o=n.executeFunction(v,t)}else s&&(o=s[c]);const p=r.normalizationField,b=null!=s&&null!=p?parseFloat(s[p]):void 0;if(null!=o&&(!p||t||!isNaN(b)&&0!==b)){isNaN(b)||t||(o/=b);const e=y(o,d);if(e){const n=e[0],t=e[1],l=n===t?r.stops[n].color:i.A.blendColors(r.stops[n].color,r.stops[t].color,e[2],null!=a?a.color:void 0);return new i.A(l)}}}function p(e,n,a){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"opacity"===e.type)):e;if(!i)return;if("esri.renderers.visualVariables.OpacityVariable"!==i.declaredClass)return void u().warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const r="number"==typeof n,t=r?null:n,l=null===t||void 0===t?void 0:t.attributes;let s=r?n:null;const o=i.field,{ipData:c,hasExpression:d}=i.cache;let f=i.cache.compiledFunc;if(!o&&!d){const e=i.stops;return e&&e[0]&&e[0].opacity}if("number"!=typeof s)if(d){if(null==(null===a||void 0===a?void 0:a.arcade))return void u().error("Use of arcade expressions requires an arcade context");const e={viewingMode:a.viewingMode,scale:a.scale,spatialReference:a.spatialReference},n=a.arcade.arcadeUtils,r=n.getViewInfo(e),l=n.createExecContext(t,r,a.timeZone);if(!f){const e=n.createSyntaxTree(i.valueExpression);f=n.createFunction(e),i.cache.compiledFunc=f}s=n.executeFunction(f,l)}else l&&(s=l[o]);const v=i.normalizationField,p=null!=l&&null!=v?parseFloat(l[v]):void 0;if(null!=s&&(!v||r||!isNaN(p)&&0!==p)){isNaN(p)||r||(s/=p);const e=y(s,c);if(e){const n=e[0],a=e[1];if(n===a)return i.stops[n].opacity;{const r=i.stops[n].opacity;return r+(i.stops[a].opacity-r)*e[2]}}}}function b(e,n,a){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"rotation"===e.type)):e;if(!i)return;if("esri.renderers.visualVariables.RotationVariable"!==i.declaredClass)return void u().warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const r=i.axis||"heading",t="heading"===r&&"arithmetic"===i.rotationType?90:0,l="heading"===r&&"arithmetic"===i.rotationType?-1:1,s="number"==typeof n?null:n,o=null===s||void 0===s?void 0:s.attributes,c=i.field,{hasExpression:d}=i.cache;let f=i.cache.compiledFunc,v=0;if(!c&&!d)return v;if(d){if(null==(null===a||void 0===a?void 0:a.arcade))return void u().error("Use of arcade expressions requires an arcade context");const e={viewingMode:a.viewingMode,scale:a.scale,spatialReference:a.spatialReference},n=a.arcade.arcadeUtils,r=n.getViewInfo(e),t=n.createExecContext(s,r,a.timeZone);if(!f){const e=n.createSyntaxTree(i.valueExpression);f=n.createFunction(e),i.cache.compiledFunc=f}v=n.executeFunction(f,t)}else o&&(v=o[c]||0);return v="number"!=typeof v||isNaN(v)?null:t+l*v,v}function h(e,n,a){const i="visualVariables"in e&&e.visualVariables?e.visualVariables.find((e=>"size"===e.type)):e;if(!i)return;if("esri.renderers.visualVariables.SizeVariable"!==i.declaredClass)return void u().warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const r=w(function(e,n,a){const i="number"==typeof n,r=i?null:n,t=null===r||void 0===r?void 0:r.attributes;let l=i?n:null;const{isScaleDriven:s}=e.cache;let c=e.cache.compiledFunc;if(s){const n=null!=a?a.scale:void 0,i=null!=a?a.view:void 0;l=null==n||"3d"===i?function(e){let n=null,a=null;const i=e.stops;return i?(n=i[0].value,a=i[i.length-1].value):(n=e.minDataValue||0,a=e.maxDataValue||0),(n+a)/2}(e):n}else if(!i)switch(e.inputValueType){case o.Yf.Expression:{if(null==(null===a||void 0===a?void 0:a.arcade))return void u().error("Use of arcade expressions requires an arcade context");const n={viewingMode:a.viewingMode,scale:a.scale,spatialReference:a.spatialReference},i=a.arcade.arcadeUtils,t=i.getViewInfo(n),s=i.createExecContext(r,t,a.timeZone);if(!c){const n=i.createSyntaxTree(e.valueExpression);c=i.createFunction(n),e.cache.compiledFunc=c}l=i.executeFunction(c,s);break}case o.Yf.Field:t&&(l=t[e.field]);break;case o.Yf.Unknown:l=null}if(!(0,o.gf)(l))return null;if(i||!e.normalizationField)return l;const d=t?parseFloat(t[e.normalizationField]):null;return(0,o.gf)(d)&&0!==d?l/d:null}(i,n,a),i,n,a,i.cache.ipData);return null==r||isNaN(r)?0:r}function m(e,n,a){return null==e?null:(0,o.of)(e)?h(e,n,a):(0,o.gf)(e)?e:null}function V(e,n,a){return(0,o.gf)(a)&&e>a?a:(0,o.gf)(n)&&e<n?n:e}function w(e,n,a,i,r){switch(n.transformationType){case o._w.Additive:return function(e,n,a,i){var r;return e+(null!==(r=m(n.minSize,a,i)||n.minDataValue)&&void 0!==r?r:0)}(e,n,a,i);case o._w.Constant:return function(e,n,a){const i=e.stops;let r=(null===i||void 0===i?void 0:i.length)&&i[0].size;return null==r&&(r=e.minSize),m(r,n,a)}(n,a,i);case o._w.ClampedLinear:return function(e,n,a,i){const r=(e-n.minDataValue)/(n.maxDataValue-n.minDataValue),t=m(n.minSize,a,i),l=m(n.maxSize,a,i),s=null!=i?i.shape:void 0;if(e<=n.minDataValue)return t;if(e>=n.maxDataValue)return l;if(null==t||null==l)return null;if("area"===n.scaleBy&&s){const e="circle"===s,n=e?d*(t/2)**2:t*t,a=n+r*((e?d*(l/2)**2:l*l)-n);return e?2*Math.sqrt(a/d):Math.sqrt(a)}return t+r*(l-t)}(e,n,a,i);case o._w.Proportional:return function(e,n,a,i){const r=null!=i?i.shape:void 0,t=e/n.minDataValue,l=m(n.minSize,a,i),s=m(n.maxSize,a,i);let o=null;return o="circle"===r?2*Math.sqrt(t*(l/2)**2):"square"===r||"diamond"===r||"image"===r?Math.sqrt(t*l**2):t*l,V(o,l,s)}(e,n,a,i);case o._w.Stops:return function(e,n,a,i,r){var t;const[l,s,o]=y(e,r);if(l===s)return m(null===(t=n.stops)||void 0===t?void 0:t[l].size,a,i);{var u,c;const e=m(null===(u=n.stops)||void 0===u?void 0:u[l].size,a,i);return e+(m(null===(c=n.stops)||void 0===c?void 0:c[s].size,a,i)-e)*o}}(e,n,a,i,r);case o._w.RealWorldSize:return function(e,n,a,i){var r;const t=(null!==(r=null===i||void 0===i?void 0:i.resolution)&&void 0!==r?r:1)*s.j[n.valueUnit],l=m(n.minSize,a,i),o=m(n.maxSize,a,i),{valueRepresentation:u}=n;let c=null;return c="area"===u?2*Math.sqrt(e/d)/t:"radius"===u||"distance"===u?2*e/t:e/t,V(c,l,o)}(e,n,a,i);case o._w.Identity:return e;case o._w.Unknown:return null}}function x(e,n,a){const{isScaleDriven:i}=e.cache;if(!(i&&"3d"===a||n))return null;const r={scale:n,view:a};let t=m(e.minSize,c,r),l=m(e.maxSize,c,r);if(null!=t||null!=l){if(t>l){const e=l;l=t,t=e}return{minSize:t,maxSize:l}}}function g(e,n,a){if(!e.visualVariables)return;const i=[],r=[],t=[],l=[],s=[];for(const o of e.visualVariables)switch(o.type){case"color":r.push(o);break;case"opacity":t.push(o);break;case"rotation":s.push(o);break;case"size":l.push(o)}return r.forEach((e=>{const r=v(e,n,a);i.push({variable:e,value:r})})),t.forEach((e=>{const r=p(e,n,a);i.push({variable:e,value:r})})),s.forEach((e=>{const r=b(e,n,a);i.push({variable:e,value:r})})),l.forEach((e=>{const r=h(e,n,a);i.push({variable:e,value:r})})),i.filter((e=>null!=e.value))}function y(e,n){if(!n)return;let a=0,i=n.length-1;return n.some(((n,r)=>e<n?(i=r,!0):(a=r,!1))),[a,i,(e-n[a])/(n[i]-n[a])]}function S(e,n,a){const i=["proportional","proportional","proportional"];for(const r of e){const e=r.useSymbolValue?"symbol-value":h(r,n,a);switch(r.axis){case"width":i[0]=e;break;case"depth":i[1]=e;break;case"height":i[2]=e;break;case"width-and-depth":i[0]=e,i[1]=e;break;case"all":case void 0:case null:i[0]=e,i[1]=e,i[2]=e;break;default:(0,t.Xb)(r.axis)}}return i}}}]);
//# sourceMappingURL=5492.9848d565.chunk.js.map